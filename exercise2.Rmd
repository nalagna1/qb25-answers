---
title: "exercise2"
output: html_document
date: "2025-09-17"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
library(tidyverse)
setwd('/Users/cmdb/qb25-answers/week1')
header <- c("chr", "start", "end", "count")
df19 <- read_tsv("hg19-kc-count.bed", col_names=header)
df16 <- read_tsv("hg16-kc-count.bed", col_names=header)

df_combined <- bind_rows(hg19=df19, hg16=df16, .id="assembly")

ggplot(df_combined, aes(x=start/1e6, y=count, color=assembly)) +
  geom_line() +
  facet_wrap(~chr, scales="free_x") +
  labs(x="Position (Mb)", y="Gene count per 1Mb", title="Gene density: hg19 vs hg16") +
  theme_minimal()
ggsave("exercise2.png", width=12, height=8)
```

```{r}
combined <- bind_rows(hg19 = hg19_df, hg16 = hg16_df, .id = "assembly") 
```
```{r}
ggplot(combined, aes(x = start/1e6, y = count, color = assembly)) +
  geom_line() +
  facet_wrap(~ chr, scales = "free_x", ncol = 5) +
  labs(title = "Gene density: hg19 vs hg16", x = "Position (Mb)", y = "Genes per 1 Mb")
ggsave("exercise2.png", width = 12, height = 8, dpi = 300)
```

